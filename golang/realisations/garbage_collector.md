Here’s a translated and formatted version of your text:

---

### Стек и куча в RAM

**Стек** и **куча** располагаются в оперативной памяти (RAM).

- **Стек** используется для хранения:
  - Локальных переменных,
  - Адреса возврата,
  - И других временных данных.
  
  Он имеет фиксированный размер и не поддерживает динамическое выделение памяти.

- **Куча** ограничена только доступными ресурсами системы.

### Сборщик мусора (GC) - Mark and Sweep

GC работает параллельно с программой, используя **трёхцветную** маркировку: белый, черный и серый.

1. **Изначально все объекты белые.**
   
2. **Корневые объекты** - это глобальные переменные или переменные в стеке текущего потока.
   - GC проверяет стек и глобальные переменные на ссылки на кучу.
   - Если ссылка найдена, объект помечается и добавляется в **очередь серых**.
   
3. Затем GC сканирует очередь серых объектов, добавляя найденные объекты в очередь серых.
   - Исходный объект перемещается в **очередь черных**.

4. Когда очередь серых объектов пуста, все белые объекты удаляются.

#### Особенности работы GC

- **Write Barrier** - для обеспечения целостности структуры кучи при изменениях.  
   - **Write Barrier** помогает **мутации** (спутнику основного GC), чтобы он следил за тем, чтобы черные элементы не ссылались на белые.

- **Stop the World (STW)** - когда программа в Go полностью останавливается на время работы GC.

### Когда запускать GC?

- Вручную можно вызвать `runtime.gc()`, но это может заблокировать работу программы.

- **Pacer** управляет GC, когда размер кучи превышает начальный в **2 раза**.
  - Коэффициент можно настроить через переменную окружения `GOGC`.